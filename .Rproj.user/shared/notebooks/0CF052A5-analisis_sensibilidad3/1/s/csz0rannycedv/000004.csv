"0","sens = function(paramet, obj){"
"0","  paramet = paramet[order(-paramet[,paste0(obj)]),]"
"0","  sa = vector(length = 0)"
"0","  for(i in 1:12){"
"0","    ecdf0 = ecdf(paramet[,i])"
"0","    ecdf1 = ecdf(paramet[1:100,i])"
"0","    tt = max(abs(ecdf0(paramet[1:100,i])-ecdf1(paramet[1:100,i])))"
"0","    sa = c(sa,tt)"
"0","  }"
"0","  return(sa)"
"0","}"
"0",""
"0","sa_nse = data.frame(parametro = colnames(mypar)[1:12],"
"0","                    nse1=sens(mypar,""nse1""),"
"0","                    nse2=sens(mypar,""nse2""),"
"0","                    nse3=sens(mypar,""nse3""),"
"0","                    nse4=sens(mypar,""nse4""),"
"0","                    nse_mean=sens(mypar,""NSE_mean""))"
"0","                    "
"0",""
"0",""
"0","fig <- plot_ly(sa_nse, x = ~parametro, y = ~nse1, type = 'bar', name = 'nse1')"
"0","fig <- fig %>% add_trace(y = ~nse2, name = 'nse2')"
"0","fig <- fig %>% add_trace(y = ~nse3, name = 'nse3')"
"0","fig <- fig %>% add_trace(y = ~nse4, name = 'nse4')"
"0","fig <- fig %>% add_trace(y = ~nse_mean, name = 'NSE_mean')"
"0","fig <- fig %>% layout(yaxis = list(title = 'Sensibilidad'), barmode = 'group')"
"0",""
"0","fig"
